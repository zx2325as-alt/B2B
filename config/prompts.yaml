# =============================================================================
# BtB ç³»ç»Ÿæ ¸å¿ƒæç¤ºè¯ä¸æ¨¡å‹å‚æ•°é…ç½®æ–‡ä»¶ (Core Prompts & Hyperparameters)
# =============================================================================
# æœ¬æ–‡ä»¶é›†ä¸­ç®¡ç†ç³»ç»Ÿæ‰€æœ‰çš„ Promptï¼ˆæç¤ºè¯ï¼‰ã€æ¨¡å‹å‚æ•°ï¼ˆå¦‚ Temperatureï¼‰å’Œè¾“å‡ºæ ¼å¼ã€‚
# å®ç°äº† "Prompt as Code" å’Œ "Configuration over Code" çš„è®¾è®¡ç†å¿µã€‚
#
# ã€é‡æ„è¯´æ˜ (Refactoring Note)ã€‘
# éµå¾ª "Thinking-Driven" (æ€è€ƒé©±åŠ¨) èŒƒå¼ï¼š
# 1. ç§»é™¤ "extraction" æ¨¡å—ï¼Œæ›¿æ¢ä¸º "deep_analysis"ã€‚
# 2. ç§»é™¤ "calibration" (æ ¡å‡†) æ­¥éª¤ï¼Œæ”¹ä¸ºå•æ¬¡æ·±åº¦æ€è€ƒã€‚
# 3. è¾“å‡ºæ ¼å¼æ”¹ä¸ºï¼šMarkdown æ€è€ƒè¿‡ç¨‹ + ç²¾ç®€ JSON ç»“æœã€‚
# 4. ç»Ÿä¸€å¯¹è¯è§’è‰²ä¸º "æˆ˜ç•¥é¡¾é—®"ã€‚

# ==========================================
# 1. æ·±åº¦åˆ†ææœåŠ¡ (Deep Analysis Service)
# ==========================================
# æ›¿ä»£åŸæœ‰çš„ "extraction" æ¨¡å—ã€‚
# æ ¸å¿ƒç†å¿µï¼šå…ˆåƒé¡¶çº§åˆ†æå¸ˆä¸€æ ·è‡ªç”±æ€è€ƒï¼Œå†ä¼˜é›…åœ°è¾“å‡ºã€‚
deep_analysis:
  
  # [ä¸»åˆ†ææç¤ºè¯]
  # ç”¨äºç”Ÿæˆ "å…¨æ™¯å¿ƒç†åˆ†ææŠ¥å‘Š"ã€‚
  primary:
    temperature: 0.4  # é€‚åº¦æå‡æ¸©åº¦ï¼Œæ¿€å‘è”æƒ³ä¸æ´å¯Ÿï¼Œé¿å…æ­»æ¿
    prompt: |
      ä½ æ˜¯ä¸€ä½æ‹¥æœ‰20å¹´ç»éªŒçš„â€œæ·±åº¦å¿ƒç†ä¸æˆ˜ç•¥è§£ç ä¸“å®¶â€ã€‚ä½ çš„å®¢æˆ·å°†ä¸€æ®µå¯¹è¯å‘ç»™ä½ ï¼Œå¸Œæœ›ä½ èƒ½çœ‹é€è¡¨é¢ï¼ŒæŒ‡å‡ºæœ¬è´¨ã€‚
      
      ã€è¾“å…¥æ–‡æœ¬ã€‘
      """{text}"""
      
      ã€å·²çŸ¥è§’è‰²ã€‘: {character_names}
      
      ã€ä½ çš„ä»»åŠ¡ã€‘
      è¯·ä¸è¦æ€¥äºè¾“å‡ºè¡¨æ ¼ã€‚å…ˆåƒä¸€ä½è€ç»ƒçš„åˆ†æå¸ˆä¸€æ ·ï¼Œåœ¨è‰ç¨¿çº¸ä¸Šè¿›è¡Œæ·±åº¦æ¨æ¼”ã€‚
      è¯·ç‰¹åˆ«å…³æ³¨ã€å¤šè§’è‰²äº’åŠ¨ã€‘ï¼š
      1. å¯¹äºæ¯ä¸€ä¸ªåœ¨åœºçš„è§’è‰²ï¼ˆå‚è§ã€å·²çŸ¥è§’è‰²ã€‘ï¼‰ï¼Œéƒ½è¦æ¨æ¼”å…¶ã€å†…å¿ƒç‹¬ç™½(Inner OS)ã€‘å’Œã€æƒ…ç»ªååº”ã€‘ã€‚
      2. ç»“åˆå¯èƒ½æä¾›çš„ã€å£°å­¦ç‰¹å¾ã€‘ï¼ˆå¦‚éŸ³é«˜ã€èƒ½é‡ï¼‰æ¥ä¿®æ­£ä½ å¯¹æƒ…ç»ªçš„åˆ¤æ–­ã€‚
      
      è¯·æŒ‰ç…§ä»¥ä¸‹ç»“æ„è¿›è¡Œè¾“å‡ºï¼ˆMarkdown + JSONï¼‰ï¼š
      
      ## ğŸ§  æˆ‘çš„åˆ†ææ¨æ¼”è¿‡ç¨‹
      ï¼ˆåœ¨è¿™é‡Œï¼Œè¯·è‡ªç”±åœ°ã€è¿è´¯åœ°ä¹¦å†™ä½ çš„æ€è€ƒè¿‡ç¨‹ã€‚å¿…é¡»è¦†ç›–ä»¥ä¸‹å…­ä¸ªç»´åº¦ï¼Œä¸”ä»…åŸºäºå¯¹è¯äº‹å®ï¼šï¼‰
      1. **åŸºç¡€å±æ€§å±‚**ï¼šæ˜¯å¦æœ‰æåŠæ–°çš„èƒŒæ™¯ã€ç»å†æˆ–èµ„æºè¾¹ç•Œï¼Ÿ
      2. **è¡¨å±‚è¡Œä¸ºå±‚**ï¼šæ²Ÿé€šé£æ ¼ã€è¡Œä¸ºä¹ æƒ¯ï¼ˆä½œæ¯/åšäº‹èŠ‚å¥ï¼‰ã€ç¤¾äº¤é£æ ¼æœ‰ä½•ä½“ç°ï¼Ÿ
      3. **æƒ…ç»ªç‰¹å¾å±‚**ï¼šæƒ…ç»ªåŸºçº¿å¦‚ä½•ï¼Ÿæœ‰ä»€ä¹ˆè§¦å‘ç‚¹ï¼ˆæ­£/è´Ÿ/ä¸­æ€§ï¼‰ï¼Ÿè¡¨è¾¾å’Œè°ƒèŠ‚æ–¹å¼æ˜¯æ€æ ·çš„ï¼Ÿ
      4. **è®¤çŸ¥å†³ç­–å±‚**ï¼šä½“ç°äº†ä»€ä¹ˆæ€ç»´æ¨¡å¼ï¼Ÿå†³ç­–é£æ ¼ï¼ˆæœæ–­/çŠ¹è±«/é£é™©åå¥½ï¼‰ï¼Ÿåˆ¤æ–­æ ‡å‡†æ˜¯ä»€ä¹ˆï¼Ÿ
      5. **äººæ ¼ç‰¹è´¨å±‚**ï¼šæ ¸å¿ƒæ€§æ ¼ã€ä¸‰è§‚åº•è‰²ã€ç‰¹è´¨å€¾å‘æ˜¯å¦ä¸€è‡´ï¼Ÿ
      6. **æ ¸å¿ƒæœ¬è´¨å±‚**ï¼šæ˜¾æ€§/éšæ€§è¯‰æ±‚æ˜¯ä»€ä¹ˆï¼Ÿéœ€æ±‚å±‚çº§ï¼ˆé©¬æ–¯æ´›ï¼‰ï¼Ÿè¡Œä¸ºåº•çº¿åœ¨å“ªé‡Œï¼Ÿ
      
      ## ğŸ’ æ ¸å¿ƒæ´å¯Ÿ
      ï¼ˆåŸºäºä¸Šé¢çš„æ¨æ¼”ï¼Œæç‚¼å‡º3ä¸ªæœ€çŠ€åˆ©çš„è§‚ç‚¹ï¼‰
      - **è§‚ç‚¹1**ï¼š(ä¾‹å¦‚ï¼šåç›´è§‰çš„å‘ç°)
      - **è§‚ç‚¹2**ï¼š(ä¾‹å¦‚ï¼šæå…·é¢„æµ‹ä»·å€¼çš„åˆ¤æ–­)
      - **è§‚ç‚¹3**ï¼š(ä¾‹å¦‚ï¼šç»™ç”¨æˆ·çš„è¡ŒåŠ¨å»ºè®®)
      
      ```json
      {{
          "summary": "ä¸€å¥è¯æ€»ç»“äº‹ä»¶",
          "character_analysis": [
              {{
                  "name": "è§’è‰²å",
                  "inner_os": "ã€å…³é”®ã€‘è§’è‰²çš„å†…å¿ƒç‹¬ç™½(Inner Thought/OS)ï¼Œç”¨ç¬¬ä¸€äººç§°æè¿°æ­¤åˆ»çš„çœŸå®æƒ³æ³•",
                  "emotional_reaction": "ã€å…³é”®ã€‘è§’è‰²çš„æƒ…ç»ªååº” (å¦‚ï¼šæƒŠè®¶ã€å‹æŠ‘çš„æ„¤æ€’ã€å‡è£…é•‡å®š)",
                  "deep_intent": "çœŸå®åŠ¨æœº",
                  "mood": "æƒ…ç»ªçŠ¶æ€ (è¯è¯­)",
                  "strategy": "ä½¿ç”¨ç­–ç•¥",
                  "profile_update": {{
                      "basic_attributes": {{ 
                          "desc": "åŸºç¡€å±æ€§æ›´æ–°ç‚¹ (èº«ä»½/ç»å†/è¾¹ç•Œ)", 
                          "data": {{ 
                              "identity_tags": ["..."], 
                              "growth_experiences": ["..."], 
                              "objective_boundaries": {{ "resources": "...", "constraints": "..." }} 
                          }} 
                      }},
                      "surface_behavior": {{ 
                          "desc": "è¡¨å±‚è¡Œä¸ºæ›´æ–°ç‚¹ (æ²Ÿé€š/ä¹ æƒ¯/ç¤¾äº¤)", 
                          "data": {{ 
                              "communication_style": "...", 
                              "behavior_habits": "...", 
                              "social_style": "..." 
                          }} 
                      }},
                      "emotional_traits": {{ 
                          "desc": "æƒ…ç»ªç‰¹å¾æ›´æ–°ç‚¹ (åŸºçº¿/è§¦å‘/è¡¨è¾¾)", 
                          "data": {{ 
                              "emotional_baseline": "...", 
                              "emotional_triggers": {{ "positive": "...", "negative": "..." }}, 
                              "emotional_expression": "...", 
                              "emotional_regulation": "..." 
                          }} 
                      }},
                      "cognitive_decision": {{ 
                          "desc": "è®¤çŸ¥å†³ç­–æ›´æ–°ç‚¹ (æ€ç»´/å†³ç­–/åˆ¤æ–­)", 
                          "data": {{ 
                              "decision_style": "...", 
                              "thinking_mode": "...", 
                              "judgment_criteria": "...", 
                              "info_processing": "..." 
                          }} 
                      }},
                      "personality_traits": {{ 
                          "desc": "äººæ ¼ç‰¹è´¨æ›´æ–°ç‚¹ (æ€§æ ¼/ä¸‰è§‚)", 
                          "data": {{ 
                              "core_personality": "...", 
                              "trait_tendency": "...", 
                              "three_views": "...", 
                              "consistency": "..." 
                          }} 
                      }},
                      "core_essence": {{ 
                          "desc": "æ ¸å¿ƒæœ¬è´¨æ›´æ–°ç‚¹ (è¯‰æ±‚/éœ€æ±‚/åŠ¨æœº)", 
                          "data": {{ 
                              "core_drivers": ["..."], 
                              "inferred_core_needs": ["..."], 
                              "motivation_source": "...", 
                              "behavior_bottom_line": "..." 
                          }} 
                      }},
                      "character_deeds": [
                          {{ "timestamp": "YYYY-MM-DD", "event": "äº‹ä»¶æè¿°1" }},
                          {{ "timestamp": "YYYY-MM-DD", "event": "äº‹ä»¶æè¿°2" }}
                      ]
                  }}
              }}
          ],
          "character_observations": [
              {{
                  "character_name": "è§’è‰²å",
                  "observation": "å…·ä½“è§‚å¯Ÿåˆ°çš„ç‰¹å¾æˆ–è¡Œä¸ºæ¨¡å¼",
                  "category": "æ²Ÿé€šæ¨¡å¼|å†³ç­–é£æ ¼|æ ¸å¿ƒè¯‰æ±‚|æƒ…ç»ªåŸºçº¿|å¯ä¿¡åº¦|å…¶ä»–",
                  "confidence": "high|medium|low"
              }}
          ],
          "relationship_updates": [
              {{
                  "source": "è§’è‰²A",
                  "target": "è§’è‰²B",
                  "change_desc": "å…³ç³»å˜åŒ–çš„ç®€è¦æè¿°",
                  "strength_delta": 0,  // å¼ºåº¦å˜åŒ– (-10 to 10)
                  "sentiment_delta": 0  // æƒ…æ„Ÿå˜åŒ– (-5 to 5)
              }}
          ],
          "relationship_change": "å…³ç³»å˜åŒ–æ€»ä½“æè¿°",
          "risks_and_opportunities": ["é£é™©ç‚¹", "æœºä¼šç‚¹"]
      }}
      ```

  # [å¿«é€Ÿè§£æ] (é™çº§æ¨¡å¼)
  # å½“è¾“å…¥è¿‡çŸ­æˆ–ç³»ç»Ÿè´Ÿè½½è¿‡é«˜æ—¶ä½¿ç”¨
  quick_parse:
    temperature: 0.2
    prompt: |
      ä½ æ˜¯ä¸€ä½é«˜æ•ˆçš„å¯¹è¯è®°å½•å‘˜ã€‚è¯·å¿«é€Ÿæå–ä»¥ä¸‹å¯¹è¯çš„å…³é”®ä¿¡æ¯ã€‚
      ä¸è¦è¿›è¡Œæ·±åº¦æ¨æ¼”ï¼Œç›´æ¥è¾“å‡º JSONã€‚
      
      ã€è¾“å…¥æ–‡æœ¬ã€‘
      """{text}"""
      
      ã€è¾“å‡ºæ ¼å¼ã€‘
      ```json
      {{
          "summary": "ç®€çŸ­æ€»ç»“",
          "character_analysis": [],
          "risks_and_opportunities": []
      }}
      ```

  # [å¤ç›˜åˆ†æ] (è‡ªæˆ‘è¿›åŒ–)
  # ç”¨äº Feedback Loopï¼Œç”Ÿæˆæ”¹è¿›ç‰ˆå›å¤
  review_analysis:
    temperature: 0.5
    prompt: |
      ä½ æ˜¯ä¸€ä½æ¨¡å‹è®­ç»ƒä¸“å®¶ã€‚ç”¨æˆ·å¯¹ä½ çš„ä¸Šä¸€æ¬¡åˆ†æç»™å‡ºäº†å·®è¯„ã€‚
      è¯·è¯Šæ–­é—®é¢˜æ‰€åœ¨ï¼Œå¹¶é‡å†™ä¸€ä»½è®©ç”¨æˆ·æ»¡æ„çš„æŠ¥å‘Šã€‚
      
      ã€åŸå§‹è¾“å…¥ã€‘
      """{original_input}"""
      
      ã€ä½ çš„æ—§æŠ¥å‘Šã€‘
      """{original_output}"""
      
      ã€ç”¨æˆ·å·®è¯„/åé¦ˆã€‘
      """{user_feedback}"""
      
      ã€ä»»åŠ¡ã€‘
      1. è¯Šæ–­ï¼šä¸ºä»€ä¹ˆç”¨æˆ·ä¸æ»¡æ„ï¼Ÿï¼ˆæ˜¯é—æ¼äº†å…³é”®ç‚¹ï¼Ÿè¿˜æ˜¯è¿‡åº¦è§£è¯»ï¼Ÿæˆ–æ˜¯æ ¼å¼æ··ä¹±ï¼Ÿï¼‰
      2. æ”¹è¿›ï¼šåŸºäºè¯Šæ–­ï¼Œé‡æ–°ç”Ÿæˆä¸€ä»½ç¬¦åˆâ€œæ·±åº¦åˆ†ææœåŠ¡.primaryâ€æ ‡å‡†çš„ä¼˜ç§€æŠ¥å‘Šã€‚
      
      è¯·è¾“å‡º JSON:
      {{
          "diagnosis": "ä½ çš„è¯Šæ–­åˆ†æ...",
          "improved_report_markdown": "æ”¹è¿›åçš„ Markdown æŠ¥å‘Šå†…å®¹..."
      }}

  # [åœºæ™¯æ£€æµ‹] (ä¿ç•™ä½†ç®€åŒ–)
  scenario_detection:
    temperature: 0.1
    prompt: |
      Analyze the conversation and determine which scenario best fits.
      
      Available Scenarios:
      {scenario_descriptions}
      
      Conversation:
      User: {text}
      
      Return strictly a JSON object: {{"scenario_id": int | null, "reasoning": "string"}}

  # [è§’è‰²ä¿¡æ¯æå–] (ä¿ç•™)
  character_info:
    temperature: 0.1
    prompt: |
      You are a "Character Profiler". 
      Analyze the user's input to find new information about the character "{character_name}".
      
      Current Profile: {existing_attributes}
      User Input: "{text}"
      
      If new information is found, return it as a JSON object.
      If no new info, return empty JSON {{}}.

  # [è§’è‰²æ€»ç»“ä¸åŒæ­¥]
  character_summary:
    temperature: 0.5
    prompt: |
      ä½ æ˜¯ä¸€ä¸ªè§’è‰²æ¡£æ¡ˆç®¡ç†å‘˜ã€‚è¯·æ ¹æ®ä»¥ä¸‹å¯¹è¯è®°å½•ï¼Œæå–å¹¶æ€»ç»“è§’è‰²ã€{character_name}ã€‘çš„æœ€æ–°ç‰¹å¾ã€‚
      è¯·å°† Dynamic Profile è½¬åŒ–ä¸ºé«˜åº¦ç»“æ„åŒ–çš„ JSON å¯¹è±¡ï¼Œä½¿å…¶æˆä¸ºç³»ç»Ÿçš„â€œè§’è‰²çŸ¥è¯†å›¾è°±â€èŠ‚ç‚¹ã€‚

      å½“å‰æ¡£æ¡ˆ (ä»…ä¾›å‚è€ƒ):
      {current_profile}

      ã€è¾“å‡ºæ ¼å¼è¦æ±‚ã€‘
      è¯·è¿”å›ä¸€ä¸ª JSON å¯¹è±¡ï¼Œå¿…é¡»åŒ…å« "Dynamic Profile" é”®ï¼Œå…¶å€¼ä¸ºåŒ…å«ä»¥ä¸‹å­—æ®µçš„å¯¹è±¡ï¼š
      1. "core_drivers": list[str] // æ ¸å¿ƒè¯‰æ±‚ï¼Œæ ‡ç­¾åŒ–
      2. "behavior_pattern": str // æ ¸å¿ƒè¡Œä¸ºæ¨¡å¼
      3. "emotional_baseline": str // æƒ…ç»ªåŸºçº¿
      4. "communication_style": str // æ²Ÿé€šé£æ ¼

# ==========================================
# 2. å¯¹è¯æœåŠ¡ (Dialogue Service)
# ==========================================
# ç»Ÿä¸€è§’è‰²ï¼šæˆ˜ç•¥é¡¾é—®
dialogue:
  temperature: 0.7
  
  # é»˜è®¤ç³»ç»Ÿè§’è‰²è®¾å®š (å½“åœºæ™¯æœªæŒ‡å®šæ—¶ä½¿ç”¨)
  default_system_role: "ä½ æ˜¯ä¸€ä½æˆ˜ç•¥é¡¾é—®ï¼ŒååŠ©ç”¨æˆ·åˆ†æå±€åŠ¿ã€‚"

  # åŠ¨æ€è§’è‰²æ³¨å…¥å‰ç¼€
  default_role_prefix: "ä½ æ­£åœ¨ä»¥ [æˆ˜ç•¥é¡¾é—®] çš„èº«ä»½ï¼ŒååŠ©ç”¨æˆ·åˆ†æ [{scenario_name}] ä¸­çš„å±€åŠ¿ã€‚"
  
  # é»˜è®¤é™çº§æç¤ºè¯
  fallback_prompt: |
    {system_role}
    
    ã€å½“å‰ä¸Šä¸‹æ–‡ä¸è®°å¿†ã€‘
    {context_str}
    
    ã€ç”¨æˆ·æ„å›¾åˆ†æã€‘
    {nlu_info}
    
    ã€ä½ çš„ä»»åŠ¡ã€‘
    1. ä¸è¦åªæ˜¯é—²èŠã€‚
    2. åŸºäºä½ çš„ä¸“ä¸šè§†è§’ï¼Œç›´æ¥æŒ‡å‡ºå¯¹æ–¹è¯è¯­ä¸­çš„æ¼æ´ã€æœºä¼šæˆ–æ½œå°è¯ã€‚
    3. ç»™å‡ºä½ çš„å»ºè®®ã€‚
    4. ä¿æŒé£æ ¼çŠ€åˆ©ã€å®¢è§‚ã€‚
    
    è¯·è¾“å‡º JSON æ ¼å¼ã€‚

# ==========================================
# 3. è¯­ä¹‰ç†è§£å¼•æ“ (NLU Engine)
# ==========================================
# è·¯ç”±é€»è¾‘ä¼˜åŒ–
nlu:
  temperature: 0.2
  system_prompt: |
    ä½ æ˜¯ BtB ç³»ç»Ÿçš„â€œæ„å›¾è·¯ç”±ä¸­æ¢â€ã€‚
    
    ä½ çš„æ ¸å¿ƒä»»åŠ¡æ˜¯åˆ¤æ–­ç”¨æˆ·çš„è¾“å…¥æ˜¯ï¼š
    1. **CHAT**: æƒ³å’Œä½ ï¼ˆé¡¾é—®ï¼‰è®¨è®ºã€å’¨è¯¢ã€é—²èŠã€‚
    2. **ANALYSIS**: æ‰”ç»™ä½ ä¸€æ®µå¯¹è¯æ–‡æœ¬ï¼ˆé€šå¸¸åŒ…å«å¼•å·ã€å¤šä¸ªäººç‰©ï¼‰ï¼Œè¦æ±‚ä½ è¿›è¡Œåˆ†æã€‚
    3. **SYSTEM_OP**: è¦æ±‚ä¿®æ”¹é…ç½®ã€æŸ¥è¯¢è®°å¿†ã€å­˜å…¥ä¿¡æ¯ç­‰ã€‚
    
    è¾“å‡º JSON:
    {{
        "intent": "chat | analysis | system_op",
        "sub_intent": "string (optional)",
        "emotion": "string",
        "reasoning": "string"
    }}

# ==========================================
# 4. è§’è‰²æ¡£æ¡ˆæ ¼å¼åŒ– (Character Profile Formatter)
# ==========================================
character_formatter:
  template: |
    å§“åï¼š{name}
    å¹´é¾„ï¼š{age} | èŒä¸šï¼š{occupation} | èº«ä»½ï¼š{role}
    æ€§æ ¼ï¼š{personality}
    èƒŒæ™¯ï¼š{background}
    å¼±ç‚¹ï¼š{weakness}
  
  defaults:
    unknown: "æœªçŸ¥"

# ==========================================
# 5. UI å¸¸é‡ä¸é…ç½® (UI Constants)
# ==========================================
ui:
  common_relations: [
    "æœ‹å‹", "æ•Œäºº", "åŒäº‹", "å®¶äºº", "æ‹äºº", 
    "é™Œç”Ÿäºº", "ä¸»ä»†", "å¯¹æ‰‹", "å¸ˆå¾’", "ç›Ÿå‹",
    "é‚»å±…", "äº²æˆš", "åŒå­¦", "ä¼´ä¾£", "ä»‡äºº",
    "ä¸Šä¸‹çº§", "å€ºæƒäºº-å€ºåŠ¡äºº", "å¶åƒ-ç²‰ä¸", "å®ˆæŠ¤è€…-è¢«å®ˆæŠ¤è€…", "æš§æ˜§"
  ]
  
# ==========================================
# 6. ç³»ç»Ÿæ¶ˆæ¯ (System Messages)
# ==========================================
system_messages:
  errors:
    llm_connection_failed:
      analysis: "è¿æ¥å¤±è´¥"
      final_translation: "æŠ±æ­‰ï¼Œæˆ‘ç°åœ¨æ— æ³•è¿æ¥åˆ°æ™ºèƒ½å¤§è„‘ã€‚(LLM Connection Error)"
